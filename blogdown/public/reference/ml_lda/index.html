<!DOCTYPE html>
<html>
<head>
  <script>
    theBaseUrl = location.origin + "/";
  </script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
  <title>Spark ML -- Latent Dirichlet Allocation</title>
  <meta name="generator" content="Hugo 0.26" />

  
  <meta name="description" content="An R interface to Spark">
  
  <link rel="canonical" href="/reference/ml_lda/">
  

  <meta property="og:url" content="/reference/ml_lda/">
  <meta property="og:title" content="sparklyr">
  <meta name="apple-mobile-web-app-title" content="sparklyr">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <style>
    @font-face {
      font-family: 'Icon';
      src: url('fonts/icon.eot?52m981');
      src: url('fonts/icon.eot?#iefix52m981')
      format('embedded-opentype'),
      url('fonts/icon.woff?52m981')
      format('woff'),
      url('fonts/icon.ttf?52m981')
      format('truetype'),
      url('fonts/icon.svg?52m981#icon')
      format('svg');
      font-weight: normal;
      font-style: normal;
    }
  </style>


  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/site-styles.css">

  <script src="/js/vendor.js"></script>

  <script src="/js/app.js"></script>
  
  <link rel="shortcut icon" href="/images/favicon.png">

  
</head>
<body>


<div class="single-page">
  <nav data-gumshoe-header aria-label="Header" id="header" class="top-menu">
  <div class="left">
     <a href = "/" data-parenturl="" class="top-menu-item site-title">sparklyr</a>
     <span class="logo-from">from</span>
     <a href="/">
      <div id="logo" class="logo"></div>
    </a>
  </div>


  <div class="right">
    <div class="top-menu-items" id="top-menu-items">
        <a href="/dplyr" data-parenturl="/dplyr" class="top-menu-item">dplyr</a>
        <a href="/mlib" data-parenturl="/mlib" class="top-menu-item">MLib</a>
        <a href="/extensions" data-parenturl="/extensions" class="top-menu-item">Extensions</a>
        <a href="/news" data-parenturl="/news" class="top-menu-item">News</a>
        <a href="/reference" data-parenturl="/reference" class="top-menu-item">Reference</a>
    </div>
    

    
    
  </div>
</nav>

<nav aria-label="Header" id="mobile-header">
  <a href = "/">sparklyr</a>
  <div class="right">
    <a href="https://github.com/rstudio/sparklyr" class="github-logo">
      <i class="fa fa-lg fa-github" aria-hidden="true"></i>
    </a>
    <div class="hamburger">
      <i class="fa fa-lg fa-bars" aria-hidden="true"></i>
    </div>

  </div>

</nav>

<div id="mobile-menu-container">
<ul id="mobile-menu">
  
    <li>
      <a href="">Using sparklyr</a>
       <i class="fa fa-chevron-right" aria-hidden="true"></i>
    </li>
    <ul>
    
      <li>
        <a href="/guides/connections/">Getting Started</a>
        
      </li>
      
    
      <li>
        <a href="/dplyr/">Manipulating data</a>
        
      </li>
      
    
      <li>
        <a href="/mlib/">Machine Learning</a>
        
      </li>
      
    
      <li>
        <a href="/guides/caching/">Understanding Caching</a>
        
      </li>
      
    
      <li>
        <a href="/deployment/">Deployment Options</a>
        
      </li>
      
    
    </ul>
  
    <li>
      <a href="">Guides</a>
       <i class="fa fa-chevron-right" aria-hidden="true"></i>
    </li>
    <ul>
    
      <li>
        <a href="/guides/distributed-r/">Distributed R</a>
        
      </li>
      
    
      <li>
        <a href="/guides/data-lakes/">Data Lakes</a>
        
      </li>
      
    
      <li>
        <a href="/extensions/">Extend sparklyr</a>
        
      </li>
      
    
      <li>
        <a href="/guides/textmining">Text mining</a>
        
      </li>
      
    
    </ul>
  
    <li>
      <a href="/examples/">Deployment Examples</a>
       <i class="fa fa-chevron-right" aria-hidden="true"></i>
    </li>
    <ul>
    
      <li>
        <a href="/examples/stand-alone-aws/">Standalone cluster (AWS)</a>
        
      </li>
      
    
      <li>
        <a href="/examples/yarn-cluster-emr/">YARN cluster (EMR)</a>
        
      </li>
      
    
      <li>
        <a href="/examples/cloudera-aws/">Cloudera cluster</a>
        
      </li>
      
    
    </ul>
  
    <li>
      <a href="/reference/">Reference</a>
       
    </li>
    <ul>
    
    </ul>
  
</ul>
</div>

<div id="search-bar" class="search-bar">
  <p class="search-bar__icon"><i class="fa fa-lg fa-search"></i> </p>
  <div class="search-bar__input">
      <input type="text" name="search" class="st-default-search-input">
  </div>
  <div class="search-bar__exit">
    <i class="fa fa-lg fa-times"></i>
  </div>

  <div class="inline-search-results">
    <ul>

    </ul>
  </div>
</div>



</div>

<div class="page documentation">
    <div class="side-menu" id="side-menu">
    
    
  

    

        <a href="" class="side-menu__item__link">
          <img class="side-menu__item__link__icon" src="/images/icons/block-retina.png" alt="">
          <p class="side-menu__item__link__text">Using sparklyr</p>
        </a>

        <ul class="side-menu__sub">
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/guides/connections/" class="side-menu__sub__item__text" href="/guides/connections/" data-url="/guides/connections/">Getting Started</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/dplyr/" class="side-menu__sub__item__text" href="/dplyr/" data-url="/dplyr/">Manipulating data</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/mlib/" class="side-menu__sub__item__text" href="/mlib/" data-url="/mlib/">Machine Learning</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/guides/caching/" class="side-menu__sub__item__text" href="/guides/caching/" data-url="/guides/caching/">Understanding Caching</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/deployment/" class="side-menu__sub__item__text" href="/deployment/" data-url="/deployment/">Deployment Options</a>
            </li>
          
        </ul>
          

    

        <a href="" class="side-menu__item__link">
          <img class="side-menu__item__link__icon" src="/images/icons/block-retina.png" alt="">
          <p class="side-menu__item__link__text">Guides</p>
        </a>

        <ul class="side-menu__sub">
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/guides/distributed-r/" class="side-menu__sub__item__text" href="/guides/distributed-r/" data-url="/guides/distributed-r/">Distributed R</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/guides/data-lakes/" class="side-menu__sub__item__text" href="/guides/data-lakes/" data-url="/guides/data-lakes/">Data Lakes</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/extensions/" class="side-menu__sub__item__text" href="/extensions/" data-url="/extensions/">Extend sparklyr</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/guides/textmining" class="side-menu__sub__item__text" href="/guides/textmining" data-url="/guides/textmining">Text mining</a>
            </li>
          
        </ul>
          

    

        <a href="/examples/" class="side-menu__item__link">
          <img class="side-menu__item__link__icon" src="/images/icons/block-retina.png" alt="">
          <p class="side-menu__item__link__text">Deployment Examples</p>
        </a>

        <ul class="side-menu__sub">
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/examples/stand-alone-aws/" class="side-menu__sub__item__text" href="/examples/stand-alone-aws/" data-url="/examples/stand-alone-aws/">Standalone cluster (AWS)</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/examples/yarn-cluster-emr/" class="side-menu__sub__item__text" href="/examples/yarn-cluster-emr/" data-url="/examples/yarn-cluster-emr/">YARN cluster (EMR)</a>
            </li>
          
            <li class="side-menu__sub__item ">
              <a id="menu-link-/examples/cloudera-aws/" class="side-menu__sub__item__text" href="/examples/cloudera-aws/" data-url="/examples/cloudera-aws/">Cloudera cluster</a>
            </li>
          
        </ul>
          

    

        <a href="/reference/" class="side-menu__item__link">
          <img class="side-menu__item__link__icon" src="/images/icons/block-retina.png" alt="">
          <p class="side-menu__item__link__text">Reference</p>
        </a>

        <ul class="side-menu__sub">
          
        </ul>
          

    
    
    
    </div>
    <div class="content">

      <h1 class="content-header">Spark ML -- Latent Dirichlet Allocation </h1>

      <div class="markdowned">
      <div class="doc-page">
    
      <div class="doc-page-index">
      <ul id="gumshoe-container" data-gumshoe>
      </ul>
      </div>
  
      <div class="doc-page-body">  
        <div class="doc-page">
    
    <div class="doc-page-index">
    <ul data-gumshoe>
    <li><a href="#arguments">Arguments</a></li>
    
    <li><a href="#note">Note</a></li>

    <li><a href="#references">References</a></li>

    <li><a href="#see-also">See also</a></li>
    
    <li><a href="#examples">Examples</a></li>
    </ul>
    </div>

    <div class="doc-page-body">

    
    <p>Fit a Latent Dirichlet Allocation (LDA) model to a Spark DataFrame.</p>
    

    <div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ml_lda</span>(<span class='no'>x</span>, <span class='kw'>features</span> <span class='kw'>=</span> <span class='fu'>tbl_vars</span>(<span class='no'>x</span>), <span class='kw'>k</span> <span class='kw'>=</span> <span class='fu'>length</span>(<span class='no'>features</span>), <span class='kw'>alpha</span> <span class='kw'>=</span> (<span class='fl'>50</span>/<span class='no'>k</span>) +
  <span class='fl'>1</span>, <span class='kw'>beta</span> <span class='kw'>=</span> <span class='fl'>0.1</span> + <span class='fl'>1</span>, <span class='kw'>optimizer</span> <span class='kw'>=</span> <span class='st'>"online"</span>, <span class='kw'>max.iterations</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>ml.options</span> <span class='kw'>=</span> <span class='fu'><a href='ml_options'>ml_options</a></span>(), <span class='no'>...</span>)</code></pre></div>
    
    <h2 id="arguments">Arguments</h2>
    <table class="ref-arguments">
    
    <colgroup>
      <col class="name" />
      <col class="desc" />
    </colgroup>  
      
    <tr>
      <td>x</td>
      <td><p>An object coercable to a Spark DataFrame (typically, a
<code>tbl_spark</code>).</p></td>
    </tr>
    <tr>
      <td>features</td>
      <td><p>The name of features (terms) to use for the model fit.</p></td>
    </tr>
    <tr>
      <td>k</td>
      <td><p>The number of topics to estimate.</p></td>
    </tr>
    <tr>
      <td>alpha</td>
      <td><p>Concentration parameter for the prior placed on documents' distributions over topics. This is a singleton which is replicated to a vector of length <code>k</code> in fitting (as currently EM optimizer only supports symmetric distributions, so all values in the vector should be the same). For Expectation-Maximization optimizer values should be &gt; 1.0.
By default <code>alpha = (50 / k) + 1</code>, where <code>50/k</code> is common in LDA libraries and +1 follows from Asuncion et al. (2009), who recommend a +1 adjustment for EM.</p></td>
    </tr>
    <tr>
      <td>beta</td>
      <td><p>Concentration parameter for the prior placed on topics' distributions over terms. For Expectation-Maximization optimizer value should be &gt; 1.0 and by default <code>beta = 0.1 + 1</code>, where 0.1 gives a small amount of smoothing and +1 follows Asuncion et al. (2009), who recommend a +1 adjustment for EM.</p></td>
    </tr>
    <tr>
      <td>optimizer</td>
      <td><p>The optimizer, either <code>online</code> for Online Variational Bayes or <code>em</code> for Expectation-Maximization.</p></td>
    </tr>
    <tr>
      <td>max.iterations</td>
      <td><p>Maximum number of iterations.</p></td>
    </tr>
    <tr>
      <td>ml.options</td>
      <td><p>Optional arguments, used to affect the model generated. See
<code><a href='ml_options'>ml_options</a></code> for more details.</p></td>
    </tr>
    <tr>
      <td>...</td>
      <td><p>Optional arguments. The <code>data</code> argument can be used to
specify the data to be used when <code>x</code> is a formula; this allows calls
of the form <code><a href='ml_linear_regression'>ml_linear_regression(y ~ x, data = tbl)</a></code>, and is
especially useful in conjunction with <code>do</code>.</p></td>
    </tr>
    </table>
    
    <h2 id="note">Note</h2>

    <p>The topics' distributions over terms are called "beta" in the original LDA paper by Blei et al., but are called "phi" in many later papers such as Asuncion et al., 2009.</p>
<p>For terminology used in LDA model see <a href='https://spark.apache.org/docs/latest/api/scala/index#org.apache.spark.ml.clustering.LDA'>Spark LDA documentation</a>.</p>
<p>Expectation-Maximization: Asuncion et al. <a href='http://arxiv.org/pdf/1205.2662.pdf'>On Smoothing and Inference for Topic Models.</a> Uncertainty in Artificial Intelligence, 2009.</p>
    
    <h2 id="references">References</h2>

    <p>Original LDA paper (journal version): Blei, Ng, and Jordan. "Latent Dirichlet Allocation." JMLR, 2003.</p>
<p>Asuncion et al. (2009)</p>
    
    <h2 id="see-also">See also</h2>

    <p>Other Spark ML routines: <code><a href='ml_als_factorization'>ml_als_factorization</a></code>,
  <code><a href='ml_decision_tree'>ml_decision_tree</a></code>,
  <code><a href='ml_generalized_linear_regression'>ml_generalized_linear_regression</a></code>,
  <code><a href='ml_gradient_boosted_trees'>ml_gradient_boosted_trees</a></code>,
  <code><a href='ml_kmeans'>ml_kmeans</a></code>,
  <code><a href='ml_linear_regression'>ml_linear_regression</a></code>,
  <code><a href='ml_logistic_regression'>ml_logistic_regression</a></code>,
  <code><a href='ml_multilayer_perceptron'>ml_multilayer_perceptron</a></code>,
  <code><a href='ml_naive_bayes'>ml_naive_bayes</a></code>,
  <code><a href='ml_one_vs_rest'>ml_one_vs_rest</a></code>, <code><a href='ml_pca'>ml_pca</a></code>,
  <code><a href='ml_random_forest'>ml_random_forest</a></code>,
  <code><a href='ml_survival_regression'>ml_survival_regression</a></code></p>
    

    <h2 id="examples">Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class='co'># NOT RUN {</span>
<span class='fu'>library</span>(<span class='no'>janeaustenr</span>)
<span class='fu'>library</span>(<span class='no'>sparklyr</span>)
<span class='fu'>library</span>(<span class='no'>dplyr</span>)

<span class='no'>sc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='spark-connections'>spark_connect</a></span>(<span class='kw'>master</span> <span class='kw'>=</span> <span class='st'>"local"</span>)

<span class='no'>austen_books</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/janeaustenr/topics/austen_books'>austen_books</a></span>()
<span class='no'>books_tbl</span> <span class='kw'>&lt;-</span> <span class='fu'>sdf_copy_to</span>(<span class='no'>sc</span>, <span class='no'>austen_books</span>, <span class='kw'>overwrite</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>first_tbl</span> <span class='kw'>&lt;-</span> <span class='no'>books_tbl</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter'>filter</a></span>(<span class='fu'>nchar</span>(<span class='no'>text</span>) <span class='kw'>&gt;</span> <span class='fl'>0</span>) <span class='kw'>%&gt;%</span> <span class='fu'>head</span>(<span class='fl'>100</span>)

<span class='no'>first_tbl</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='ft_tokenizer'>ft_tokenizer</a></span>(<span class='st'>"text"</span>, <span class='st'>"tokens"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='ft_count_vectorizer'>ft_count_vectorizer</a></span>(<span class='st'>"tokens"</span>, <span class='st'>"features"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'>ml_lda</span>(<span class='st'>"features"</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='co'># }</span></code></pre></div>
    
    </div>
    
    </div>


        
      </div>
      </div>
      </div>
      
      
<footer>



</footer>
      
    </div>
</div>

</body>
</html>

